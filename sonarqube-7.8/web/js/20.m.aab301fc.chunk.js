(window.webpackJsonp=window.webpackJsonp||[]).push([[20],{1704:function(e,s,t){"use strict";t.r(s);var o=t(413),r=t.n(o),i=t(363),n=t(379),a=t.n(n),p=t(0);class l extends i.PureComponent{render(){const e=this.props.organization?Object(p.l)("permissions.page"):Object(p.l)("global_permissions.page"),s=this.props.organization?Object(p.l)("organization_permissions.page.description"):Object(p.l)("global_permissions.page.description");return i.createElement("header",{className:"page-header"},i.createElement("h1",{className:"page-title"},e),this.props.loading&&i.createElement("i",{className:"spinner"}),i.createElement("div",{className:"page-description"},s))}}var u=t(375),g=t(867),m=t(892),h=t(402),d=t(595),c=t(377);var v=Object(u.connect)(e=>({appState:Object(c.getAppState)(e)}))(class extends i.PureComponent{constructor(){super(...arguments),this.handleToggleUser=((e,s)=>e.permissions.includes(s)?this.props.revokePermissionFromUser(e.login,s):this.props.grantPermissionToUser(e.login,s)),this.handleToggleGroup=((e,s)=>e.permissions.includes(s)?this.props.revokePermissionFromGroup(e.name,s):this.props.grantPermissionToGroup(e.name,s))}render(){const e=this.props,s=e.filter,t=e.groups,o=e.groupsPaging,r=e.users,n=e.usersPaging,a=this.props.organization?"organizations_permissions":"global_permissions",p=this.props.appState.qualifiers.includes("VW"),l=Object(d.e)(p?d.d:d.c,a);let u=0,c=0;return"users"!==s&&(u+=t.length,c+=o?o.total:t.length),"groups"!==s&&(u+=r.length,c+=n?n.total:r.length),i.createElement(i.Fragment,null,i.createElement(m.a,{filter:this.props.filter,groups:this.props.groups,loading:this.props.loading,onToggleGroup:this.handleToggleGroup,onToggleUser:this.handleToggleUser,permissions:l,query:this.props.query,users:this.props.users},i.createElement(g.a,{filter:this.props.filter,onFilter:this.props.onFilter,onSearch:this.props.onSearch,query:this.props.query})),i.createElement(h.a,{count:u,loadMore:this.props.onLoadMore,total:c}))}}),f=t(518),P=t(386);t(868);function y(e,s){return function(e){if(Array.isArray(e))return e}(e)||function(e,s){var t=[],o=!0,r=!1,i=void 0;try{for(var n,a=e[Symbol.iterator]();!(o=(n=a.next()).done)&&(t.push(n.value),!s||t.length!==s);o=!0);}catch(e){r=!0,i=e}finally{try{o||null==a.return||a.return()}finally{if(r)throw i}}return t}(e,s)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}t.d(s,"default",function(){return S});class S extends i.PureComponent{constructor(e){super(e),this.mounted=!1,this.loadUsersAndGroups=((e,s)=>{const t=this.props.organization,o=this.state,r=o.filter,i=o.query,n="groups"!==r?f.i({q:i||void 0,organization:t&&t.key,p:e}):Promise.resolve({paging:void 0,users:[]}),a="users"!==r?f.h({q:i||void 0,organization:t&&t.key,p:s}):Promise.resolve({paging:void 0,groups:[]});return Promise.all([n,a])}),this.loadHolders=(()=>(this.setState({loading:!0}),this.loadUsersAndGroups().then(e=>{let s=y(e,2),t=s[0],o=s[1];this.mounted&&this.setState({groups:o.groups,groupsPaging:o.paging,loading:!1,users:t.users,usersPaging:t.paging})},this.stopLoading))),this.onLoadMore=(()=>{const e=this.state,s=e.usersPaging,t=e.groupsPaging;return this.setState({loading:!0}),this.loadUsersAndGroups(s?s.pageIndex+1:1,t?t.pageIndex+1:1).then(e=>{let s=y(e,2),t=s[0],o=s[1];this.mounted&&this.setState(e=>{let s=e.groups,r=e.users;return{groups:[...s,...o.groups],groupsPaging:o.paging,loading:!1,users:[...r,...t.users],usersPaging:t.paging}})},this.stopLoading)}),this.onFilter=(e=>{this.setState({filter:e},this.loadHolders)}),this.onSearch=(e=>{this.setState({query:e},this.loadHolders)}),this.addPermissionToGroup=((e,s,t)=>e.map(e=>e.name===s?Object.assign({},e,{permissions:[...e.permissions,t]}):e)),this.addPermissionToUser=((e,s,t)=>e.map(e=>e.login===s?Object.assign({},e,{permissions:[...e.permissions,t]}):e)),this.removePermissionFromGroup=((e,s,t)=>e.map(e=>e.name===s?Object.assign({},e,{permissions:r()(e.permissions,t)}):e)),this.removePermissionFromUser=((e,s,t)=>e.map(e=>e.login===s?Object.assign({},e,{permissions:r()(e.permissions,t)}):e)),this.grantPermissionToGroup=((e,s)=>this.mounted?(this.setState(t=>{let o=t.groups;return{groups:this.addPermissionToGroup(o,e,s)}}),f.o({groupName:e,permission:s,organization:this.props.organization&&this.props.organization.key}).then(()=>{},()=>{this.mounted&&this.setState(t=>{let o=t.groups;return{groups:this.removePermissionFromGroup(o,e,s)}})})):Promise.resolve()),this.grantPermissionToUser=((e,s)=>this.mounted?(this.setState(t=>{let o=t.users;return{users:this.addPermissionToUser(o,e,s)}}),f.p({login:e,permission:s,organization:this.props.organization&&this.props.organization.key}).then(()=>{},()=>{this.mounted&&this.setState(t=>{let o=t.users;return{users:this.removePermissionFromUser(o,e,s)}})})):Promise.resolve()),this.revokePermissionFromGroup=((e,s)=>this.mounted?(this.setState(t=>{let o=t.groups;return{groups:this.removePermissionFromGroup(o,e,s)}}),f.t({groupName:e,permission:s,organization:this.props.organization&&this.props.organization.key}).then(()=>{},()=>{this.mounted&&this.setState(t=>{let o=t.groups;return{groups:this.addPermissionToGroup(o,e,s)}})})):Promise.resolve()),this.revokePermissionFromUser=((e,s)=>this.mounted?(this.setState(t=>{let o=t.users;return{users:this.removePermissionFromUser(o,e,s)}}),f.u({login:e,permission:s,organization:this.props.organization&&this.props.organization.key}).then(()=>{},()=>{this.mounted&&this.setState(t=>{let o=t.users;return{users:this.addPermissionToUser(o,e,s)}})})):Promise.resolve()),this.stopLoading=(()=>{this.mounted&&this.setState({loading:!1})}),this.state={filter:"all",groups:[],loading:!0,query:"",users:[]}}componentDidMount(){this.mounted=!0,this.loadHolders()}componentWillUnmount(){this.mounted=!1}render(){return i.createElement("div",{className:"page page-limited"},i.createElement(P.a,{suggestions:"global_permissions"}),i.createElement(a.a,{title:Object(p.l)("global_permissions.permission")}),i.createElement(l,{loading:this.state.loading,organization:this.props.organization}),i.createElement(v,{filter:this.state.filter,grantPermissionToGroup:this.grantPermissionToGroup,grantPermissionToUser:this.grantPermissionToUser,groups:this.state.groups,groupsPaging:this.state.groupsPaging,loadHolders:this.loadHolders,loading:this.state.loading,onFilter:this.onFilter,onLoadMore:this.onLoadMore,onSearch:this.onSearch,query:this.state.query,revokePermissionFromGroup:this.revokePermissionFromGroup,revokePermissionFromUser:this.revokePermissionFromUser,users:this.state.users,usersPaging:this.state.usersPaging}))}}},381:function(e,s,t){"use strict";t.d(s,"a",function(){return p});var o=t(363),r=t(364),i=t(373),n=t(419),a=t(371);t(391);function p(e){const s=e.children,t=void 0===s?o.createElement(n.a,{fill:a.gray71,size:12}):s,p=e.tagName,l=void 0===p?"div":p;return o.createElement(l,{className:r("help-tooltip",e.className)},o.createElement(i.a,{mouseLeaveDelay:.25,onShow:e.onShow,overlay:e.overlay,placement:e.placement},o.createElement("span",{className:"display-inline-flex-center"},t)))}},386:function(e,s,t){"use strict";t.d(s,"a",function(){return i});var o=t(363),r=t(409);function i(e){let s=e.suggestions;return o.createElement(r.a.Consumer,null,e=>{let t=e.addSuggestions,r=e.removeSuggestions;return o.createElement(n,{addSuggestions:t,removeSuggestions:r,suggestions:s})})}class n extends o.PureComponent{componentDidMount(){this.props.addSuggestions(this.props.suggestions)}componentDidUpdate(e){e.suggestions!==this.props.suggestions&&(this.props.removeSuggestions(this.props.suggestions),this.props.addSuggestions(e.suggestions))}componentWillUnmount(){this.props.removeSuggestions(this.props.suggestions)}render(){return null}}},391:function(e,s,t){var o=t(392);"string"==typeof o&&(o=[[e.i,o,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};t(367)(o,r);o.locals&&(e.exports=o.locals)},392:function(e,s,t){(e.exports=t(366)(!1)).push([e.i,".help-tooltip{display:inline-flex;align-items:center;vertical-align:middle}.help-toolip-link{display:block;width:12px;height:12px;border:none}",""])},402:function(e,s,t){"use strict";t.d(s,"a",function(){return l});var o=t(363),r=t(364),i=t(372),n=t(0),a=t(374),p=function(e,s){var t={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&s.indexOf(o)<0&&(t[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(o=Object.getOwnPropertySymbols(e);r<o.length;r++)s.indexOf(o[r])<0&&(t[o[r]]=e[o[r]])}return t};function l(e){var s=e.ready,t=void 0===s||s,l=p(e,["ready"]);const u=l.total&&l.total>l.count,g=o.createElement("a",{className:"spacer-left",href:"#",onClick:e=>{e.preventDefault(),e.currentTarget.blur(),l.loadMore&&l.loadMore()}},Object(n.l)("show_more")),m=r("spacer-top note text-center",{"new-loading":!t},l.className);return o.createElement("footer",{className:m},Object(n.m)("x_of_y_shown",Object(a.formatMeasure)(l.count,"INT",null),Object(a.formatMeasure)(l.total,"INT",null)),null!=l.loadMore&&u?g:null,l.loading&&o.createElement(i.a,{className:"text-bottom spacer-left position-absolute"}))}}}]);
//# sourceMappingURL=20.m.aab301fc.chunk.js.map